import{t as S}from"./emojis-0ead063f.js";import{t as k,a as C}from"./strings-8042df5b.js";import{t as u,R as v,p as B,y as g,bI as c,bJ as p,bs as N,bL as l,bM as d,bK as T,bR as E}from"./index-8d305a84.js";function I(i,t){const a=[];let e=0,s;for(;(s=t.exec(i))!==null&&(s.index>e&&a.push({text:i.slice(e,s.index),isMatch:!1}),a.push({text:s[0],isMatch:!0}),e=t.lastIndex,!!t.global););return e<i.length&&a.push({text:i.slice(e),isMatch:!1}),a}const $={highlightTag:{type:String,default:"mark"},caseSensitive:Boolean,autoEscape:{type:Boolean,default:!0},text:String,patterns:{type:Array,default:()=>[]},highlightClass:String,highlightStyle:[Object,String]},H=u({name:"Highlight",props:$,setup(i){const{mergedClsPrefixRef:t}=v(),a=s=>s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{highlightedNode:B(()=>{const s=t.value;let n=[];const{patterns:h,text:o}=i;if(h.length===0||!o)n=[o];else{const{highlightTag:f,caseSensitive:m,autoEscape:x,highlightClass:_,highlightStyle:y}=i,b=h.map(r=>x?a(r):r).join("|"),M=new RegExp(`(${b})`,m?"g":"gi");n=I(o,M).map(({text:r,isMatch:R})=>R?g(f,{class:[`${s}-highlight__mark`,_],style:y},r):r)}return g("span",{class:`${s}-highlight`},n)}),mergedClsPrefix:t}},render(){return this.highlightedNode}}),L=["innerHTML"],P=u({__name:"TextMessage",props:{extra:{},data:{},maxWidth:{type:Boolean},source:{},isSearch:{type:Boolean},patterns:{}},setup(i){var s;const t=i,a=t.data.float;let e=((s=t.extra)==null?void 0:s.content)||"";return t.isSearch||(e=k(e),t.data.talk_type==2&&(e=C(e,"#1890ff")),e=S(e)),(n,h)=>t.isSearch?(c(),p("div",{key:0,class:d(["im-message-text im-message-text-search",{left:l(a)=="left",right:l(a)=="right",maxwidth:n.maxWidth,"radius-reset":n.source!="panel"}])},[N(l(H),{text:l(e),patterns:n.patterns},null,8,["text","patterns"])],2)):(c(),p("div",{key:1,class:d(["im-message-text",{left:l(a)=="left",right:l(a)=="right",maxwidth:n.maxWidth,"radius-reset":n.source!="panel"}])},[T("pre",{innerHTML:l(e)},null,8,L)],2))}});const V=E(P,[["__scopeId","data-v-4278ba68"]]);export{V as default};
