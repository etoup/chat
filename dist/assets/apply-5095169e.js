import{t as z,cN as F,r as $,p as E,C as O,w as P,bH as u,ck as B,aI as D,bI as m,bJ as g,bs as s,bP as c,bK as n,D as L,ae as M,bT as V,bN as f,bL as l,bX as H,bW as A,cc as X,dF as q,cx as N,dG as Q,dH as Y,bR as J,dI as Z,y as ee,aW as ne,dJ as se,dK as oe,bO as te,bU as ae}from"./index-8d305a84.js";import{_ as K}from"./no-data-bde0995b.js";import{u as R}from"./useInject-58e6e07a.js";import{C as W}from"./CheckSmall-880f6223.js";import{C as j}from"./Close-e5fa65a5.js";import{u as le}from"./useUtil-50c48c7c.js";import{b as U,N as ie}from"./Tabs-c78031bf.js";const ce={style:{"min-height":"300px"}},re=["onClick"],de=["onClick"],pe={class:"username"},_e={class:"time"},ue={class:"remark text-ellipsis"},me={class:"tools"},ve=z({__name:"FriendApply",setup(T){const i=F(),{showUserInfoModal:b}=R(),h=$([]),r=$(!0),v=E(()=>i.isContactApply),y=(d=!1)=>{q().then(e=>{e.code==200&&(h.value=e.data.items||[],d&&(i.isContactApply=!1))}).finally(()=>{r.value=!1})},k=d=>{b(d.user_id)},w=N(d=>{let e=window.$message.loading("请稍等，正在处理");Q({apply_id:d.id,remark:d.nickname}).then(({code:o,message:t})=>{e.destroy(),o==200?(y(),window.$message.success("已同意")):window.$message.info(t)})},1e3),S=N(d=>{let e=window.$message.loading("请稍等，正在处理");Y({apply_id:d.id,remark:"拒绝"}).then(({code:o,message:t})=>{e.destroy(),o==200?(y(),window.$message.success("已拒绝")):window.$message.info(t)})},1e3);return O(v,()=>{y(!1)}),P(()=>{y(!0)}),(d,e)=>{const o=u("n-empty"),t=u("im-avatar"),_=u("n-icon"),x=u("n-button"),I=B("loading");return D((m(),g("section",ce,[D(s(o,{size:"200",description:"暂无相关数据",style:{"margin-top":"10%"}},{icon:c(()=>e[0]||(e[0]=[n("img",{src:K,alt:""},null,-1)])),_:1},512),[[L,h.value.length==0]]),(m(!0),g(M,null,V(h.value,a=>(m(),g("div",{class:"item",key:a.id},[n("div",{class:"avatar",onClick:C=>k(a)},[s(t,{size:40,src:a.avatar,username:a.nickname},null,8,["src","username"])],8,re),n("div",{class:"content pointer o-hidden",onClick:C=>k(a)},[n("div",pe,[n("span",null,f(a.nickname),1),n("span",_e,f(l(H)(a.created_at,"{m}/{d} {h}:{i}")),1)]),n("div",ue,"备注: "+f(a.remark),1)],8,de),n("div",me,[s(x,{onClick:C=>l(w)(a),strong:"",secondary:"",circle:"",type:"primary",size:"small"},{icon:c(()=>[s(_,{component:l(W)},null,8,["component"])]),_:2},1032,["onClick"]),s(l(X),{onPositiveClick:C=>l(S)(a)},{trigger:c(()=>[s(x,{strong:"",secondary:"",circle:"",type:"tertiary",size:"small"},{icon:c(()=>[s(_,{component:l(j)},null,8,["component"])]),_:1})]),default:c(()=>[e[1]||(e[1]=A(" 确认要拒绝申请吗？ "))]),_:2},1032,["onPositiveClick"])])]))),128))])),[[I,r.value]])}}});const ye=J(ve,[["__scopeId","data-v-be995d44"]]),fe={style:{"min-height":"300px"}},ge=["onClick"],he=["onClick"],ke={class:"username"},be={class:"time"},Ce={class:"remark text-ellipsis"},$e={class:"tools"},Ae=z({__name:"GroupApply",setup(T){const{useMessage:i,useDialog:b}=le(),{showUserInfoModal:h}=R(),r=F(),v=$([]),y=$(!0),k=()=>{Z().then(e=>{e.code==200&&(v.value=e.data.items||[])}).finally(()=>{y.value=!1})},w=e=>{h(e.user_id)},S=N(e=>{let o=i.loading("请稍等，正在处理");oe({apply_id:e.id}).then(t=>{o.destroy(),t.code==200?i.success("已同意"):i.info(t.message),k()})},1e3),d=e=>{let o="",t=b.create({title:"拒绝入群申请",content:()=>ee(ne,{defaultValue:"",placeholder:"请填写拒绝原因",style:{marginTop:"20px"},onInput:_=>o=_,autofocus:!0}),negativeText:"取消",positiveText:"提交",onPositiveClick:()=>(o.length&&(t.loading=!0,se({apply_id:e.id,remark:o}).then(_=>{t.destroy(),_.code==200?i.success("已拒绝"):i.info(_.message),k()})),!1)})};return P(()=>{k(),r.isGroupApply=!1}),(e,o)=>{const t=u("n-empty"),_=u("im-avatar"),x=u("n-tag"),I=u("n-icon"),a=u("n-button"),C=B("loading");return D((m(),g("section",fe,[D(s(t,{style:{"margin-top":"10%"},size:"200",description:"暂无相关数据"},{icon:c(()=>o[0]||(o[0]=[n("img",{src:K,alt:""},null,-1)])),_:1},512),[[L,v.value.length==0]]),(m(!0),g(M,null,V(v.value,p=>(m(),g("div",{class:"item",key:p.id},[n("div",{class:"avatar",onClick:G=>w(p)},[s(_,{size:40,src:p.avatar,username:p.nickname},null,8,["src","username"])],8,ge),n("div",{class:"content pointer o-hidden",onClick:G=>w(p)},[n("div",ke,[n("span",null,[s(x,{bordered:!1,size:"small",type:"primary"},{default:c(()=>[A(f(p.group_name),1)]),_:2},1024),A(" "+f(p.nickname),1)]),n("span",be,f(l(H)(p.created_at,"{m}/{d} {h}:{i}")),1)]),n("div",Ce,"备注: "+f(p.remark),1)],8,he),n("div",$e,[s(a,{onClick:G=>l(S)(p),strong:"",secondary:"",circle:"",size:"small",type:"primary"},{icon:c(()=>[s(I,{component:l(W)},null,8,["component"])]),_:2},1032,["onClick"]),s(a,{onClick:G=>d(p),strong:"",secondary:"",circle:"",type:"tertiary",size:"small"},{icon:c(()=>[s(I,{component:l(j)},null,8,["component"])]),_:2},1032,["onClick"])])]))),128))])),[[C,y.value]])}}});const we=J(Ae,[["__scopeId","data-v-d180812c"]]),xe={class:"el-container is-vertical height100"},Ie={class:"el-header me-view-header bdr-b"},De={class:"el-main me-scrollbar me-scrollbar-thumb"},Pe=z({__name:"apply",setup(T){const i=$("friend"),b={friend:ye,group:we};return(h,r)=>(m(),g("section",xe,[n("header",Ie,[s(l(ie),{value:i.value,"onUpdate:value":r[0]||(r[0]=v=>i.value=v)},{default:c(()=>[s(l(U),{name:"friend"},{default:c(()=>r[1]||(r[1]=[A(" 好友申请 ")])),_:1}),s(l(U),{name:"group"},{default:c(()=>r[2]||(r[2]=[A(" 入群申请 ")])),_:1})]),_:1},8,["value"])]),n("main",De,[(m(),te(ae(b[i.value])))])]))}});export{Pe as default};
